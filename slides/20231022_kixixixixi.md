# 暗号の歴史 2

History of cryptography 2
@kixixixixi

---

# 前回

## 共通鍵暗号

- DES
- AES

---

# ハッシュ関数

データを混ぜて一定の長さのデータを作り出す関数。
ハッシュ = 切り刻んで混ぜる。（IBM の隠語）

以下の利用をされている。

- 改ざんの検証
- パスワードの保護
- 比較・検索の効率化
- キャッシュ（ハッシュテーブル）

---

# ハッシュ関数の特徴

- 固定長
  どんな入力でも同一の長さのハッシュ値
- 原像回復困難性
  ハッシュ値から元の入力値を復元することは困難
- 内部衝突耐性
  異なる入力値に対して、同じハッシュ値が生成される確率は極めて低い
- 外部衝突耐性
  同一入力値に対して、異なるハッシュ値が生成されない
- 衝突発見困難性
  ハッシュ値が同じになる入力を見つけることが困難

---

# ハッシュの種類

- MD5
- SHA1
- SHA2
  - SHA224
  - SHA256
  - SHA384
  - SHA512
- SHA3

---

# MD5 破られる

2004 年 MD5 が破られた

SHA1 も非推奨

---

# 公開鍵暗号

SSL など、インターネット通信の多くで利用されている暗号方式。

受信側（復号側）のみが秘密鍵を持ち、公開鍵は共有される。
攻撃者に公開鍵と暗号文、アルゴリズムを知られていても問題ない。

一方向性関数を利用。
関数の計算は簡単だが逆関数の計算が非常に困難。

---

# RSA 暗号

素因数分解の困難性を用いる。
オイラーの定理

$$ P^e \equiv C \pmod {pq} $$
$$ a^{(p-1)(q-1)} \equiv 1\pmod {pq} $$

大きな桁の素数を用意する必要があり計算量が大きい

---

# 電子署名

公開鍵暗号を利用して受信したデータが改竄なく信用できる送信元であることを確認するしくみ。

---

# 認証局

公開鍵のやりとりをする相手が信用にたるのか分からなければ中間者攻撃を受けてしまう。
認証局を利用してやり取り相手の信用を確認している。

認証局は階層構造になっていてブラウザはルート認証局をはじめから信用している。

---

# 楕円曲線暗号

RSA 暗号よりもパフォーマンスが高く広まっている公開鍵暗号の技術

楕円曲線
$$ y^2 = x^3 + ax + b $$

交換法則、結合法則

一方向性
$$P = mQ$$
という式が与えられたとき、P と Q から m を求めることは難しい
m と Q があれば P を求めるのは簡単。

---

# 楕円曲線暗号

1. 楕円曲線の係数を決定
2. 秘密鍵 m を指定
3. $P = mQ$ を求める
4. 整数 k をランダムに決める
5. r = kQ を求める
6. s = h(m) + rd / k mod n を求める

r, s が署名値
P,Q が公開鍵

---

# 暗号通貨

- 電子署名
- 公開鍵
- ハッシュ関数
- P2P

## BTC

- ナンス
  {[前回のハッシュ値] + [ナンス] + [今回のトランザクション（取引データ）] }
  のデータをハッシュ関数に通し上位の桁に 0 が規定の回数連続するハッシュ値になるナンスをもとめることがマイニング

---

# 　サイドチェネルアタック

ハードウェアを物理的に観測することで暗号を破ること。
IC チップや IoT など物理的なものに暗号技術が利用される機会が多くなったので攻撃対象が増えている。

---

# エニグマ

WW2 のドイツが用いた暗号技術
アラン・チューリングが解読
