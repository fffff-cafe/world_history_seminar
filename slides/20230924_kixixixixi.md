# 暗号の歴史 1

History of cryptography 1
@kixixixixi

---

# 暗号とは

現代の生活において欠かせない技術。
Wi-Fi、モバイル通信、IC カード、インターネット、暗号通貨など。
数学技術が集まった工学的な技術。

---

# 暗号の大別

- 共通鍵暗号
  - ストリーム暗号
  - ブロック暗号
  - ハッシュ関数
- 公開鍵暗号
  - RSA 暗号
  - 楕円曲線暗号

---

# 共通鍵暗号

閉める鍵と開ける鍵が同じ

---

# はじめての暗号、シーザー暗号

歴史上もっともシンプルな実用された暗号

アルファベットを決まった数だけ巡回的にずらすことによって暗号化する。
3 つ後にずらすのであれば A->D, F->I, Z->C

この暗号の弱さは

---

# シーザー暗号の弱さ

ずらし方が 25 通りしかない。
手計算でも解読できてしまう。

---

# 単換字暗号

アルファベットをランダムに対応づける暗号
26!通りの組み合わせがある。
= 4.032\*10^26 通り

シーザーの時代から約 1000 年にわたり単換字暗号は最強の暗号として君臨した。
だがこの暗号を破るアイディアが生まれる。

---

# 単換字暗号を破る

頻度分析。

アルファベットは均等に現れない。e の出現頻度が高い。
出現頻度の高いものから埋めていき虫食い状態にし、単語や熟語と照らし合わせて解読をすすめる。
大数の法則により文書量が多ければ多いほど解読が簡単になる。

---

# ストリーム暗号

1 ビットごとに置き換える暗号
構造が単純なのでソフトウェア・ハードウェアどちらでも小規模な実装で可能

---

# 最強の暗号、バーナム暗号

WW1 中にギルバートバーナムが考案。
理論上は安全であることが証明されている。
シンプルかつ重要な暗号。

2 進数で表記された平文と同じ長さの鍵があり、ビットごとに排他的論理和をとって暗号化する。
解読する場合は同じ鍵を用いて排他的論理和を取ればいい。

バーナム暗号は鍵がランダムな（規則性がない）条件下では（鍵が知られない限り）破ることができない。

バーナム暗号のデメリットは

---

# バーナム暗号のデメリット

毎回平文と同じ長さの鍵を送る必要がある。
使いまわしは頻度分析を行われるし、鍵の漏洩時に以後すべて解読可能になってしまう。

秘密の経路を用意し鍵を事前に毎回共有することはコストが高い。

---

# 　鍵を共有したストリーム暗号

送受信者の間で平文に対して短い鍵を共有しその鍵を伸ばして平文と排他的論理和を計算して暗号化する。

鍵の伸ばし方

- LFSR（線形フィードバックシフトレジスタ）型
  異なる周期の規則的なビット列を組み合わせることで長いビット列をつくる
- 状態遷移型
  - RC4
    RSA 社のロナルド・リベストが開発
    Wi-Fi の WEP で利用
    シンプルな作り
    ...

RC4 破られる...

---

# RC4 破られる

RC4 の作るキーストリーム（伸ばされた鍵）が乱数っぽいが本物の乱数でない。
2001 年、2 バイト目が 0 になりやすいことを発見。（通常 0 になる確率は 1/256 だが 2 倍以上あった）
排他的論理和なので該当バイトが 0 であれば暗号文は平文そのままになる。
多数の暗号文をあつめてその 2 バイト目に何が出たか数えれば一番多いものが平文 1 バイト分になっているはず。

「Breakin 104 bit WEP in less than 60 seconds」- 2007

---

# ブロック関数

ストリーム暗号は 1 ビットごとの暗号だが、複数ビット（64 ビットや 128 ビット）単位で暗号化する暗号をブロック関数という。

アルゴリズム: 以下の処理（ラウンド）を繰り返す

- 転字（転置）
  Perrmutation
  1 バイトごとの入れ替え
- 換字
  Substitution
  数バイトごとのまとめた変換
- ラウンド鍵
  秘密鍵を用いた排他的論理和

---

# 米国標準ブロック暗号 DES

Data Encryption Standard

1973 年アメリカ国立標準局が暗号化の標準規格を公募。
IBM が考案したルシファーが条件をクリア。ルシファーをベースに作られたのが DES

---

# DES 破れる

- 差分読解法
  排他的論理和が一定になる対を用意して差分を分析

- 線形読解法
  松井充
  MISTY

---

# 美しい AES

Advanced Encryption Standard

- Felica

---

# 予告

---

# ハッシュ関数

任意のデータのデータを一定の長さのデータに変換する関数。

特徴

- ハッシュ値から入力を推定できない
- すこしでも変更するとハッシュ値が大きく変わる

元のデータが改ざんされていないのか検証などに利用される

---

# 公開鍵暗号

閉める鍵と開ける鍵が異なる
非対称鍵暗号と呼ばれる
